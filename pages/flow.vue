<template>
<div class="" ref="pageObserver">
  <div class="title_block" style="text-align:center">
    <h1 class="title">ご入会からご結婚まで</h1>
  </div>
  <div class="body" id="href_1">
    <div class="menu anim">
      <div class="flow">
        <a href="#href_1" class="text --1">無料相談</a>
        <div class="nextArrow_wrap"><nextArrow class="nextArrow"></nextArrow></div>
        <a href="#href_2" class="text --2">ご入会手続き</a>
        <div class="nextArrow_wrap"><nextArrow class="nextArrow"></nextArrow></div>
        <a href="#href_3" class="text --3">プロフィール作成</a>
        <div class="nextArrow_wrap"><nextArrow class="nextArrow"></nextArrow></div>
        <a href="#href_4" class="text --4">お相手探し</a>
        <div class="nextArrow_wrap"><nextArrow class="nextArrow"></nextArrow></div>
        <a href="#href_5" class="text --5">お見合い</a>
        <div class="nextArrow_wrap"><nextArrow class="nextArrow"></nextArrow></div>
        <a href="#href_6" class="text --6">プレ交際</a>
        <div class="nextArrow_wrap"><nextArrow class="nextArrow"></nextArrow></div>
        <a href="#href_7" class="text --7">真剣交際</a>
        <div class="nextArrow_wrap"><nextArrow class="nextArrow"></nextArrow></div>
        <a href="#href_8" class="text --8">プロポーズ</a>
        <div class="nextArrow_wrap"><nextArrow class="nextArrow"></nextArrow></div>
        <a href="#href_9" class="text --9">成婚</a>
      </div>
    </div>
    <div class="body_wrap">
      <div class="section --1">
        <h1 class="title">ご入会の流れ</h1>
        <div class="section_content --1">
          <h2 class="section_title" data-number="01">無料カウンセリング</h2>
          <div class="section_body">
            <div class="body_img">
              <img class="img" src="~/assets/images/counseling.webp" alt="ステップ1">
            </div>
            <div class="body_block">
              <div class="text">
                今までの婚活状況や、いつまでに結婚したいかなどをお話し、不安を解消してから、カウンセラーがお客様ごとにベストな婚活の進め方をご提案します。
              </div>
              <div class="about">
                <nuxt-link class="ul" to="/contact">
                  <div class="inline-block li">
                    <arrow class="arrow man"></arrow>
                    <span class="form man">男性無料相談はこちら</span>
                  </div>
                </nuxt-link>
                <nuxt-link class="ul" to="/contact"> 
                  <div class="inline-block li">
                    <arrow class="arrow woman"></arrow>
                    <span class="form woman">女性無料相談はこちら</span>
                  </div>
                </nuxt-link>        
              </div>
            </div>
          </div>
          <div class="nextArrow_wrap" id="href_2">
            <nextArrow class="nextArrow"></nextArrow>
          </div>
        </div>
        <div class="section_content --2">
          <h2 class="section_title" data-number="02">ご入会手続き</h2>
          <div class="section_body">
            <div class="body_img">
              <img class="img" src="~/assets/images/flow_consulting.webp" alt="ステップ2">
            </div>
            <div class="body_block">
              <div class="text">
                入会の意思が固まったら入会手続きへと進みましょう。独身証明書などが必須のため、他の婚活サービスと比べても信頼度が高く、安心して活動が始められます。
              </div>
              <div class="about">
                <ol class="original_list">
                  <li>住民票（3カ月以内の原本）</li>
                  <li>独身証明書（3カ月以内の原本）</li>
                  <li>最終学歴証明書※短卒以上（卒業証書のコピーまたは卒業証明書）</li>
                  <li>写真付身分証明書（免許証、パスポート等）のコピー</li>
                  <li>収入証明書（源泉徴収票、所得証明等）</li>
                  <li>勤務先が確認できるもの（社員証、健康保険証等）</li>
                  <li>資格をお持ちの方はその証明書</li>
                  <li>プロフィールシート​</li>
                  <li>写真1枚以上（6か月以内に撮影したもの）</li>
                </ol>       
              </div>
            </div>
          </div>
          <div class="nextArrow_wrap" id="href_3">
            <nextArrow class="nextArrow"></nextArrow>
          </div>
        </div>
        <div class="section_content --3">
          <h2 class="section_title" data-number="03"><span class="inline-block">プロフィール作成、</span><span class="inline-block">写真撮影</span></h2>
          <div class="section_body">
            <div class="body_img">
              <img class="img" src="~/assets/images/flow_photo_studio.webp" alt="ステップ3">
            </div>
            <div class="body_block">
              <div class="text">
                結婚相談所で活動するための準備として、プロフィール作成・写真撮影を行います。婚活を効果的に進めていく上で、プロフィールと写真は重要なポイントです。　カウンセラーと一緒に仕上げることで、魅力的なプロフィールが作成できます。好印象になる自己PR文の書き方、アピールポイントをしっかりアドバイスします。写真は、多くの成婚者が利用してきたおススメのスタジオにカウンセラーも同行し、撮影していただきます。お一人で撮影に行かれるよりも、表情が柔らかくなり、より素敵な写真が撮れると言われています。
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="section --1" id="href_4">
        <h1 class="title"><span class="inline-block">お相手探しから</span><span class="inline-block">成婚まで</span></h1>
        <div class="section_content --4">
          <h2 class="section_title" data-number="01">お相手探し</h2>
          <div class="section_body">
            <div class="body_img">
              <img class="img" src="~/assets/images/flow_matching.webp" alt="ステップ4">
            </div>
            <div class="body_block">
              <div class="text">
                日本結婚相談所連盟に在籍している約80,000名の会員様の中から、プロフィールやお見合い写真などで気になる相手を探し、お見合い申込をしましょう。<br>
                パソコンやスマートフォンのアプリから、いつでもどこでもお相手を検索できるので効率的に出会えます。検索以外に、カウンセラーからの紹介も受けられるサービスもあります。
              </div>
            </div>
          </div>
          <div class="nextArrow_wrap" id="href_5">
            <nextArrow class="nextArrow"></nextArrow>
          </div>
        </div>
        <div class="section_content --5">
          <h2 class="section_title" data-number="02">お見合い</h2>
          <div class="section_body">
            <div class="body_img">
              <img class="img" src="~/assets/images/flow_first_contact.webp" alt="ステップ5">
            </div>
            <div class="body_block">
              <div class="text">
                お見合いでは、1時間程度お相手と直接会ってお話をします。お見合い中は、楽しむことを目標にお話をしてみましょう。場所はホテルのラウンジやカフェなどで行うため、落ち着いた雰囲気で、ゆっくりとお話ができます。日程調整や場所はカウンセラーがセッティングします。お見合い後のお返事は、カウンセラーを通じて確認できます。
              </div>
            </div>
          </div>
          <div class="nextArrow_wrap" id="href_6">
            <nextArrow class="nextArrow"></nextArrow>
          </div>
        </div>
        <div class="section_content --6">
          <h2 class="section_title" data-number="03"><span class="inline-block">プレ交際</span><span class="inline-block">（～交際2か月頃まで）</span></h2>
          <div class="section_body">
            <div class="body_img">
              <img class="img" src="~/assets/images/flow_pre_dating.webp" alt="ステップ6">
            </div>
            <div class="body_block">
              <div class="text">
                お見合い後にお互い印象が良ければ、プレ交際へ進みます。プレ交際とは、お相手との相性を確かめるためのお試し期間ですので、複数の方と交際することもできます。一人ひとりと向き合いながら結婚相手として相応しいか見極めることが大切です。週１回のお茶やランチなどの短時間のデートから始めて、徐々に会う時間を長くしていきましょう。メールやLineでのコミュニケーションもしっかり取りましょう。
              </div>
            </div>
          </div>
          <div class="nextArrow_wrap" id="href_7">
            <nextArrow class="nextArrow"></nextArrow>
          </div>
        </div>
        <div class="section_content --7">
          <h2 class="section_title" data-number="04"><span class="inline-block">真剣交際</span><span class="inline-block">（交際２カ月頃～）</span></h2>
          <div class="section_body">
            <div class="body_img">
              <img class="img" src="~/assets/images/flow_pre.webp" alt="ステップ7">
            </div>
            <div class="body_block">
              <div class="text">
                プレ交際のお相手と結婚前提にお付き合いしたいと思った場合は、真剣交際へ進みましょう。真剣交際では、お相手を一人に絞り、結婚前提としたお付き合いをします。プレ交際とは違い、具体的に結婚後のイメージをすり合わせることで、お互いを深く知っていきます。カウンセラーがあなたの交際状況に合わせてアドバイスします。お相手に聞きづらいことは、お相手相談所のカウンセラーを通じて確認できます。
              </div>
            </div>
          </div>
          <div class="nextArrow_wrap" id="href_8">
            <nextArrow class="nextArrow"></nextArrow>
          </div>
        </div>
        <div class="section_content --8">
          <h2 class="section_title" data-number="05">プロポーズ</h2>
          <div class="section_body">
            <div class="body_img">
              <img class="img" src="~/assets/images/flow_propose.webp" alt="ステップ8">
            </div>
            <div class="body_block">
              <div class="text">
                お互いの結婚に対する意思が固まったら、プロポーズをします。結婚相談所では、いつまでにプロポーズをするかなど、交際中も目標を決めて活動しています。そのため、相手のことを深く知ろうとする意識が働き、短期間で成婚される方が多いです。
              </div>
            </div>
          </div>
          <div class="nextArrow_wrap" id="href_9">
            <nextArrow class="nextArrow"></nextArrow>
          </div>
        </div>
        <div class="section_content --9">
          <h2 class="section_title" data-number="06">ご成婚</h2>
          <div class="section_body">
            <div class="body_img">
              <img class="img" src="~/assets/images/happy_wedding.webp" alt="ステップ9">
            </div>
            <div class="body_block">
              <div class="text">
                プロポーズが成功したら晴れてご成婚（婚約）となります。結婚相談所を退会し、結婚に向けてお二人で準備を始めましょう。
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</template>

<script setup lang="ts">
import gsap from "gsap"
import { ref, computed,  onMounted, onBeforeUnmount, useContext } from '@nuxtjs/composition-api'
import Arrow from '~/assets/images/arrow.svg'
import nextArrow from '~/assets/images/next-arrow.svg'
components: {
  Arrow
  nextArrow
}

const { app, store } = useContext()

let isDisplay = computed(() => {
  return store.getters['pageWidth'] ? store.getters['pageWidth'] >= 750 : true
})

const trigger = [
  {trigger: '.section_content.--1', action: '.text.--1'},
  {trigger: '.section_content.--2', action: '.text.--2'},
  {trigger: '.section_content.--3', action: '.text.--3'},
  {trigger: '.section_content.--4', action: '.text.--4'},
  {trigger: '.section_content.--5', action: '.text.--5'},
  {trigger: '.section_content.--6', action: '.text.--6'},
  {trigger: '.section_content.--7', action: '.text.--7'},
  {trigger: '.section_content.--8', action: '.text.--8'},
  {trigger: '.section_content.--9', action: '.text.--9'},
]

let flowBarAnim = ref<gsap.core.Tween>({} as gsap.core.Tween)
let barAnim = ref<gsap.core.Tween[]>([])

const myObserver = ref<ResizeObserver>({} as ResizeObserver)
const pageObserver = ref()

onMounted(() => {
  const resizeObserver = new ResizeObserver(entries => {
    for (const entry of entries) {
      barAnim.value.forEach((val) => {
        val.scrollTrigger?.refresh()
      })
      flowBarAnim.value.scrollTrigger?.refresh()
    }
  })
  myObserver.value = resizeObserver
  myObserver.value.observe(pageObserver.value)
  
  flowBarAnim.value = gsap.to(".menu.anim",{
    scrollTrigger: {
      trigger: '.flow',
      start: 'top 90px',
      toggleActions: 'play none none reverse',
    },
    duration: .3,
    transform: 'scale(0.8)'
  })

  trigger.forEach((value) => {
    let array: gsap.core.Tween = gsap.to(value.action, 
    {
      scrollTrigger: {
        trigger: value.trigger,
        start: 'top 60%',
        end: 'bottom 60%',
        toggleActions: 'play reverse play reverse',
      },
      duration: .3, 
      transform: 'scale(1.1)',
      'background-image': 'linear-gradient(135deg, #000875 0%, #176dee 50%,  #17aaee 100%)',
      color: '#eff4f4',
    })
    barAnim.value.push(array)
  })
})

onBeforeUnmount(() => {
  myObserver.value.unobserve(pageObserver.value)
  
  flowBarAnim.value.scrollTrigger?.disable()
  barAnim.value.forEach(value => {
    value.scrollTrigger?.disable()
  })
})
</script>


<style lang="sass" scoped>
.arrow
  display: inline-block
  width: 24px
  height: 24px
  &.man
    circle
      fill: #5f51e0
  &.woman
    circle
      fill: #e051bc

.body
  padding: 64px 0

  > .menu
    width: calc(100% - 160px)
    min-width: calc(100% - 10vw)
    margin: auto
    padding: 20px
    border-radius: 20px
    background-color: #ffffff88
    background-image: url("/images/frame-topleft.svg"), url("/images/frame-topright.svg"), url("/images/frame-bottomleft.svg"), url("/images/frame-bottomright.svg")
    background-position:  left 2px top 2px, right 2px top 2px, left 2px bottom 2px, right 2px bottom 2px
    background-size: 50px 50px
    position: sticky
    top: 75px
    z-index: 5
    display: block

    +sp-view
      display: none

    > .flow
      display: flex
      justify-content: space-around
      > .text
        +text-title(18px)
        color: var(--white-1)
        flex: 0 0 40px
        height: 160px
        writing-mode: vertical-rl
        text-align: center
        display: flex
        align-items: center
        justify-content: center
        border-radius: 20px
        background-color: #000875
        // background-image: linear-gradient(135deg, #000875 0%, #000875 100%, )

      > .nextArrow_wrap
        text-align: center
        writing-mode: vertical-rl
        width: 40px
        > .nextArrow
          display: inline-block
          transform: rotate(270deg) 
          transform-origin:70% 30%
          height: 48px

  > .body_wrap
    margin: auto
    width: 1080px
    max-width: calc(100% - 10vw)

    > .section
      border-radius: 30px
      padding: 20px 20px
      background-color: var(--white-1)
      margin: 40px 0 80px
      +sp-view
        margin: 0 0 40px

      > .title
        +text-subtitle(36px)
        position: relative
        text-align: center
        margin: 0 0 20px

        +sp-view
          +text-subtitle(28px)

        &::before 
          position: absolute
          bottom: -10px
          left: calc(50% - 50px)
          width: 100px
          height: 5px
          content: ''
          border-radius: 3px
          background-image: linear-gradient(135deg, #000875 0%, #176dee 50%,  #17aaee 100%, )
        
      > .section_content
        padding: 50px 32px

        +sp-view
          padding: 20px

        > .section_title
          +text-title(32px)
          position: relative
          margin: 0 0 20px
          display: inline-block

          +sp-view
            +text-subtitle(24px)

          &::before 
            content: attr(data-number)
            display: inline-block
            margin-right: 20px
            +text-title(44px)
            border-bottom: 1px solid var(--main)

            +sp-view
              +text-subtitle(36px)
              margin-right: 100%
              margin-bottom: 10px

          +sp-view
            &::after
              margin: 3% 0 5%

        > .section_body
          display: flex
          flex-direction: row-reverse

          +sp-view
            flex-direction: column
            gap: 20px

          > .body_img
            position: relative
            flex: 0 0 40%
            overflow: hidden
            border-radius: 20px
            height: fit-content
            +sp-view
              width: 100%
              border-radius: 20px 
            &::before
              content:""
              display: block
              padding-top: 70%
            > .img
              display: block
              position: absolute
              height: 100%
              width: 100%
              object-fit: cover
              top: 0
              bottom: 0

          > .body_block
            padding: 20px 

            +sp-view
              padding: 0
            > .text
              +text-body(18px)
              color: var(--main)
              padding: 0 0 40px
              +sp-view
                +text-body(16px)

            > .about
              > .ul
                list-style-type: none
                > .li
                  +text-subtitle(24px)
                  padding: 10px 0
                  transition-duration: .3s

                  +sp-view
                    +text-subtitle(20px)

                  &:hover
                    transform: scale(1.1)

                  > .arrow
                    position: relative
                    top: 8px
                  > .form
                    display: inline-block
                    &.man
                      border-bottom: 2px solid #5f51e0
                    &.woman
                      border-bottom: 2px solid #e051bc

        > .nextArrow_wrap
          text-align: center
          padding: 90px 0 0

          +sp-view
            padding: 40px 0 0
          > .nextArrow
            display: inline-block
            text-align: center
            path
              fill: var(--main)

</style>